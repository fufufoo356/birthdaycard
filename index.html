<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday!</title>
  <style>
    :root{
      --bg1:#0f1020;
      --bg2:#1b1f3a;
      --card:#ffffff10;
      --text:#f7f7ff;
      --muted:#cfd3ff;
      --accent:#ff4fd8;
      --accent2:#7c5cff;
      --ring:#ffffff55;
    }
    *{box-sizing:border-box}

    /* ‚úÖ iPhone-friendly scrolling + dynamic viewport */
    body{
      margin:0;
      min-height:100vh;       /* fallback */
      min-height:100dvh;      /* iOS dynamic viewport */
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1000px 600px at 20% 10%, color-mix(in oklab, var(--accent2) 40%, transparent) 0%, transparent 60%),
        radial-gradient(900px 700px at 80% 20%, color-mix(in oklab, var(--accent) 40%, transparent) 0%, transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      padding:24px;
    }
    @media (max-height: 700px){
      body{ align-items:flex-start; }
    }

    .wrap{
      width:min(820px, 100%);
      position:relative;
      margin: 12px 0;
    }

    .card{
      backdrop-filter: blur(10px);
      background: var(--card);
      border: 1px solid #ffffff25;
      border-radius: 24px;
      padding: 28px;
      box-shadow: 0 20px 60px #00000055;
      position:relative;
      overflow:hidden;
    }

    .toprow{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }

    .badge{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 14px;
      border-radius: 999px;
      background: #ffffff14;
      border:1px solid #ffffff22;
      color: var(--muted);
      font-size: 14px;
      letter-spacing:.2px;
    }

    .timebox{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius: 999px;
      background: #ffffff10;
      border:1px solid #ffffff1f;
      color: var(--muted);
      font-size: 14px;
      white-space:nowrap;
    }
    .timebox strong{ color: var(--text); font-weight: 700; }

    h1{
      margin:18px 0 6px;
      font-size: clamp(34px, 5vw, 54px);
      line-height:1.05;
    }
    .name{
      background: linear-gradient(90deg, var(--accent), #ffd36e, var(--accent2));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }

    p{
      margin: 10px 0;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.55;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      margin-top: 18px;
    }
    @media (max-width: 760px){
      .grid{grid-template-columns:1fr}
    }

    .panel{
      border-radius: 18px;
      padding: 16px;
      background:#ffffff10;
      border:1px solid #ffffff1f;
    }

    .btns{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top: 14px;
    }

    button{
      cursor:pointer;
      border:0;
      border-radius: 14px;
      padding: 12px 14px;
      font-weight: 700;
      color: #0f1020;
      background: linear-gradient(90deg, var(--accent), #ffd36e);
      box-shadow: 0 10px 25px #00000035;
      transition: transform .08s ease;
    }
    button:active{transform: translateY(1px) scale(.99)}
    .ghost{
      background:#ffffff18;
      color: var(--text);
      border:1px solid #ffffff2a;
      box-shadow:none;
      font-weight: 650;
    }

    .footer{
      margin-top: 14px;
      font-size: 13px;
      color:#b9beff;
      opacity:.9;
    }

    .hint{
      font-size: 13px;
      color:#cfd3ff;
      opacity:.9;
      margin: 0 0 6px;
    }

    .field{
      display:grid;
      gap:8px;
      margin-top:10px;
    }

    label{
      font-size: 13px;
      color:#cfd3ff;
      opacity:.9;
    }

    input, select{
      width:100%;
      padding:12px 12px;
      border-radius: 12px;
      border:1px solid #ffffff2a;
      background:#0f102040;
      color: var(--text);
      outline:none;
      appearance:none;
    }
    input::placeholder{color:#cfd3ff99}

    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 520px){
      .row2{ grid-template-columns: 1fr; }
    }

    .small{font-size:13px; opacity:.9}

    /* Floating hearts */
    .heart{
      position:absolute;
      width: 14px;
      height: 14px;
      transform: rotate(45deg);
      background: var(--accent);
      opacity:.8;
      animation: floatUp 6s linear infinite;
      border-radius: 3px;
    }
    .heart::before, .heart::after{
      content:"";
      position:absolute;
      width: 14px;
      height: 14px;
      background: inherit;
      border-radius: 50%;
    }
    .heart::before{left:-7px; top:0}
    .heart::after{left:0; top:-7px}

    @keyframes floatUp{
      from{ transform: translateY(40px) rotate(45deg); opacity:0}
      10%{opacity:.8}
      to{ transform: translateY(-820px) rotate(45deg); opacity:0}
    }

    /* Confetti canvas overlay */
    canvas{
      position:fixed;
      inset:0;
      pointer-events:none;
    }

    /* Focus styles for accessibility */
    button:focus-visible, input:focus-visible, select:focus-visible{
      outline: 3px solid var(--ring);
      outline-offset: 2px;
    }

    /* Respect Reduce Motion */
    @media (prefers-reduced-motion: reduce){
      .heart{ display:none; }
      canvas{ display:none; }
      *{ scroll-behavior:auto !important; transition:none !important; }
    }
  </style>
</head>

<body>
<canvas id="confetti"></canvas>

<div class="wrap">
  <div class="card">
    <div class="toprow">
      <div class="badge">üéÇ Free birthday card site ‚Ä¢ made with love</div>
      <div class="timebox" aria-live="polite">
        üïí Eastern time: <strong id="etTime">--:--</strong>
      </div>
    </div>

    <h1>Happy Birthday, <span class="name" id="toName">Friend</span>!</h1>
    <p id="message">
      I hope today feels a little lighter. You deserve good things, soft moments, and people who show up for you.
    </p>

    <div class="grid">
      <div class="panel">
        <p class="hint"><strong>Make it personal:</strong> fill in the info below, then press ‚ÄúUpdate‚Äù.</p>

        <div class="field">
          <label for="themeSelect">Card color / theme</label>
          <select id="themeSelect">
            <option value="pink">Pink Glow</option>
            <option value="blue">Ocean Blue</option>
            <option value="purple">Purple Night</option>
            <option value="green">Mint Dream</option>
            <option value="gold">Golden Warmth</option>
            <option value="red">Rose Red</option>
          </select>
        </div>

        <div class="field">
          <label for="nameInput">Their name</label>
          <input id="nameInput" autocomplete="off" placeholder="e.g., Sara" />
        </div>

        <div class="field">
          <label for="msgInput">Your message</label>
          <input id="msgInput" autocomplete="off" placeholder="e.g., I‚Äôm proud of you üíõ" />
        </div>

        <div class="row2" style="margin-top:10px;">
          <div class="field" style="margin-top:0;">
            <label for="emailInput">Recipient email (optional)</label>
            <input id="emailInput" type="email" inputmode="email" placeholder="e.g., sara@gmail.com" />
          </div>
          <div class="field" style="margin-top:0;">
            <label for="phoneInput">Recipient phone (optional)</label>
            <input id="phoneInput" type="tel" inputmode="tel" placeholder="e.g., 5551234567" />
          </div>
        </div>

        <div class="btns">
          <button id="updateBtn">Update</button>
          <button class="ghost" id="confettiBtn">Celebrate üéâ</button>
          <button class="ghost" id="copyBtn">Copy Link üîó</button>
          <button class="ghost" id="emailBtn">Send via Email ‚úâÔ∏è</button>
          <button class="ghost" id="textBtn">Send via Text üí¨</button>
        </div>

        <div class="footer" id="status">
          Tip: Update ‚Üí Copy Link ‚Üí send it. (Email/Text buttons open your apps with everything filled in.)
        </div>
      </div>

      <div class="panel">
        <p><strong>Little reminder:</strong></p>
        <p class="small">
          A birthday card doesn‚Äôt have to cost money to mean something.
          A link + a message can make someone feel seen.
        </p>
        <p class="small">‚Äî from you üíó</p>
      </div>
    </div>
  </div>
</div>

<script>
  // ---------- THEME SYSTEM ----------
  const THEMES = {
    pink:   { bg1:"#0f1020", bg2:"#1b1f3a", card:"#ffffff10", accent:"#ff4fd8", accent2:"#7c5cff", ring:"#ffffff55" },
    blue:   { bg1:"#06101f", bg2:"#0a2b4a", card:"#ffffff10", accent:"#52b6ff", accent2:"#2b6cff", ring:"#bfe7ff88" },
    purple: { bg1:"#0d0a1f", bg2:"#23114a", card:"#ffffff10", accent:"#b86bff", accent2:"#5c7cff", ring:"#e3c6ff66" },
    green:  { bg1:"#061a16", bg2:"#0b3a2f", card:"#ffffff10", accent:"#35f2b5", accent2:"#2fd4ff", ring:"#bfffe688" },
    gold:   { bg1:"#1a1206", bg2:"#3a250b", card:"#ffffff10", accent:"#ffd36e", accent2:"#ff7c4f", ring:"#ffe6aa77" },
    red:    { bg1:"#1a0810", bg2:"#3a0b1b", card:"#ffffff10", accent:"#ff5a6a", accent2:"#ff9a4f", ring:"#ffd0d088" }
  };

  function applyTheme(key){
    const t = THEMES[key] || THEMES.pink;
    const r = document.documentElement.style;
    r.setProperty("--bg1", t.bg1);
    r.setProperty("--bg2", t.bg2);
    r.setProperty("--card", t.card);
    r.setProperty("--accent", t.accent);
    r.setProperty("--accent2", t.accent2);
    r.setProperty("--ring", t.ring);
  }

  // ---------- ELEMENTS ----------
  const toName = document.getElementById("toName");
  const message = document.getElementById("message");
  const statusEl = document.getElementById("status");

  const themeSelect = document.getElementById("themeSelect");
  const nameInput = document.getElementById("nameInput");
  const msgInput  = document.getElementById("msgInput");
  const emailInput = document.getElementById("emailInput");
  const phoneInput = document.getElementById("phoneInput");

  // ---------- SHAREABLE LINK (URL PARAMS) ----------
  const params = new URLSearchParams(location.search);

  // Params supported: to, msg, theme
  const initialName = params.get("to");
  const initialMsg  = params.get("msg");
  const initialTheme = params.get("theme");

  // ---------- DRAFT SAVE (localStorage) ----------
  const DRAFT_KEY = "birthday_card_draft_v2";
  const saved = JSON.parse(localStorage.getItem(DRAFT_KEY) || "null");

  // Theme priority: URL > saved > default
  const themeToUse = initialTheme || saved?.theme || "pink";
  themeSelect.value = themeToUse;
  applyTheme(themeToUse);

  // Name/message priority: URL > saved > defaults
  if (initialName) toName.textContent = initialName;
  else if (saved?.to) toName.textContent = saved.to;

  if (initialMsg) message.textContent = initialMsg;
  else if (saved?.msg) message.textContent = saved.msg;

  // Inputs start values
  nameInput.value = initialName || saved?.to || "";
  msgInput.value  = initialMsg || saved?.msg || "";
  emailInput.value = saved?.email || "";
  phoneInput.value = saved?.phone || "";

  function saveDraft(){
    localStorage.setItem(DRAFT_KEY, JSON.stringify({
      theme: themeSelect.value,
      to: nameInput.value.trim(),
      msg: msgInput.value.trim(),
      email: emailInput.value.trim(),
      phone: phoneInput.value.trim()
    }));
  }

  nameInput.addEventListener("input", saveDraft);
  msgInput.addEventListener("input", saveDraft);
  emailInput.addEventListener("input", saveDraft);
  phoneInput.addEventListener("input", saveDraft);

  themeSelect.addEventListener("change", () => {
    applyTheme(themeSelect.value);
    saveDraft();
    // update URL theme (so it shares nicely)
    params.set("theme", themeSelect.value);
    history.replaceState({}, "", location.origin + location.pathname + "?" + params.toString());
    statusEl.textContent = "Theme updated ‚ú®";
  });

  document.getElementById("updateBtn").addEventListener("click", () => {
    const n = nameInput.value.trim() || "Friend";
    const m = msgInput.value.trim() || message.textContent.trim();
    const th = themeSelect.value || "pink";

    toName.textContent = n;
    message.textContent = m;

    params.set("to", n);
    params.set("msg", m);
    params.set("theme", th);

    const newUrl = location.origin + location.pathname + "?" + params.toString();
    history.replaceState({}, "", newUrl);

    saveDraft();
    statusEl.textContent = "Updated! Now press ‚ÄúCopy Link‚Äù (or Email/Text) and send it ‚úÖ";
  });

  document.getElementById("copyBtn").addEventListener("click", async () => {
    try{
      await navigator.clipboard.writeText(location.href);
      statusEl.textContent = "Link copied ‚úÖ Paste it in a text message!";
    }catch(e){
      statusEl.textContent = "Couldn‚Äôt auto-copy. Manually copy from the address bar.";
    }
  });

  // ---------- EMAIL + TEXT (opens apps with prefilled content) ----------
  function buildCardText() {
    const n = (toName.textContent || "Friend").trim();
    const m = (message.textContent || "").trim();
    const link = location.href;
    return `Happy Birthday, ${n}!\n\n${m}\n\nOpen your card here:\n${link}`;
  }

  document.getElementById("emailBtn").addEventListener("click", () => {
    const to = (emailInput.value || "").trim();
    const subject = encodeURIComponent(`Happy Birthday, ${toName.textContent || "Friend"}! üéÇ`);
    const body = encodeURIComponent(buildCardText());
    window.location.href = `mailto:${encodeURIComponent(to)}?subject=${subject}&body=${body}`;
    statusEl.textContent = "Opening your email app‚Ä¶ ‚úâÔ∏è";
  });

  document.getElementById("textBtn").addEventListener("click", () => {
    const numRaw = (phoneInput.value || "").trim();
    const num = numRaw.replace(/[^\d+]/g, "");
    const body = encodeURIComponent(buildCardText());

    // iPhone commonly supports sms:number&body=...
    // If some devices prefer ?body=, they still usually handle &body too.
    window.location.href = `sms:${encodeURIComponent(num)}&body=${body}`;
    statusEl.textContent = "Opening your messages app‚Ä¶ üí¨";
  });

  // ---------- FLOATING HEARTS ----------
  function spawnHeart(){
    const h = document.createElement("div");
    h.className = "heart";
    h.style.left = Math.random() * 100 + "vw";
    h.style.bottom = "-30px";
    h.style.animationDuration = (4 + Math.random()*4) + "s";
    h.style.opacity = 0.45 + Math.random()*0.5;
    h.style.transform = "rotate(45deg) scale(" + (0.7 + Math.random()*1.2) + ")";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(), 8000);
  }
  setInterval(spawnHeart, 520);

  // ---------- CONFETTI ----------
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  function resize(){
    canvas.width = innerWidth;
    canvas.height = innerHeight;
  }
  addEventListener("resize", resize);
  resize();

  let pieces = [];
  function blastConfetti(){
    pieces = [];
    const count = 190;
    for(let i=0;i<count;i++){
      pieces.push({
        x: innerWidth/2,
        y: innerHeight/2,
        vx: (Math.random()-0.5)*16,
        vy: (Math.random()-0.8)*18,
        g: 0.22 + Math.random()*0.08,
        s: 3 + Math.random()*5,
        r: Math.random()*Math.PI
      });
    }
  }

  function tick(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const p of pieces){
      p.vy += p.g;
      p.x += p.vx;
      p.y += p.vy;
      p.r += 0.1;

      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.r);
      ctx.fillStyle = `hsl(${(p.x+p.y)%360}, 90%, 65%)`;
      ctx.fillRect(-p.s/2, -p.s/2, p.s, p.s);
      ctx.restore();
    }
    pieces = pieces.filter(p => p.y < innerHeight + 40);
    requestAnimationFrame(tick);
  }
  tick();

  document.getElementById("confettiBtn").addEventListener("click", () => {
    blastConfetti();
    statusEl.textContent = "Wooo!! üéâ";
  });

  // ---------- EASTERN TIME (Northeastern US) ----------
  const etEl = document.getElementById("etTime");
  function updateEasternTime(){
    const d = new Date();
    const fmt = new Intl.DateTimeFormat("en-US", {
      timeZone: "America/New_York",
      weekday: "short",
      hour: "numeric",
      minute: "2-digit",
      hour12: true
    });
    etEl.textContent = fmt.format(d);
  }
  updateEasternTime();
  setInterval(updateEasternTime, 1000 * 20); // update every 20s
</script>
</body>
</html>

